<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>كومندس للصرف</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(135deg, #e0f7fa, #ffffff);
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    header {
      background-color: #00897b;
      width: 100%;
      padding: 20px 0;
      text-align: center;
      color: white;
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 20px;
    }

    .container {
      margin: 20px;
      padding: 20px;
      width: 90%;
      max-width: 400px;
      background-color: white;
      border-radius: 15px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      box-sizing: border-box;
    }

    .conversion-box {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 20px;
    }

    select, input {
      padding: 12px;
      font-size: 16px;
      border-radius: 10px;
      border: 1px solid #ccc;
      width: 100%;
      box-sizing: border-box;
    }

    button {
      padding: 12px;
      background-color: teal;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      cursor: pointer;
    }

    .converted-result {
      text-align: center;
      font-size: 20px;
      margin: 15px 0;
      color: #333;
      font-weight: bold;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    th, td {
      padding: 10px;
      border-bottom: 1px solid #eee;
      text-align: center;
    }

    th {
      background-color: #f2f2f2;
    }

    .last-updated {
      text-align: center;
      margin-top: 10px;
      color: gray;
      font-size: 13px;
    }

    footer {
      width: 100%;
      text-align: center;
      padding: 10px;
      font-size: 12px;
      color: gray;
      background-color: #f5f5f5;
      margin-top: 20px;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .conversion-box {
        gap: 12px;
      }

      button {
        font-size: 16px;
      }

      .converted-result {
        font-size: 18px;
      }

      table {
        font-size: 12px;
      }

      th, td {
        padding: 8px;
      }
    }
  </style>
</head>

<body>

  <header>كومندس للصرف</header>

  <div class="container">
    <div class="conversion-box">
      <input type="number" id="amount" value="1" min="0" placeholder="أدخل الكمية" />
      <select id="fromCurrency"></select>
      <select id="toCurrency"></select>
      <button onclick="convertAmount()">تحويل</button>
    </div>

    <div class="converted-result" id="convertedResult">...</div>

    <table>
      <thead>
        <tr>
          <th>العملة</th>
          <th>السعر مقابل العملة الأساسية</th>
        </tr>
      </thead>
      <tbody id="ratesBody">
        <tr><td colspan="2">جاري التحميل...</td></tr>
      </tbody>
    </table>

    <div class="last-updated" id="updatedTime">آخر تحديث: جاري التحميل...</div>
  </div>

  <footer>
    تطبيق صرف جميع العملات تم الإنشاء والتطوير بواسطة كومندس
  </footer>

  <script>
    let allRates = {};
    const fromSelect = document.getElementById('fromCurrency');
    const toSelect = document.getElementById('toCurrency');
    const ratesBody = document.getElementById('ratesBody');
    const resultDiv = document.getElementById('convertedResult');
    const updatedTime = document.getElementById('updatedTime');

    async function loadSymbols() {
      try {
        const res = await fetch('https://api.exchangerate.host/symbols');
        const data = await res.json();
        const symbols = data.symbols;
        for (let code in symbols) {
          const opt1 = document.createElement('option');
          const opt2 = document.createElement('option');
          opt1.value = opt2.value = code;
          opt1.text = opt2.text = `${code} - ${symbols[code].description}`;
          fromSelect.appendChild(opt1);
          toSelect.appendChild(opt2);
        }
        fromSelect.value = 'USD';
        toSelect.value = 'EUR';
        fetchRates();
      } catch (err) {
        resultDiv.innerText = 'حدث خطأ في تحميل العملات.';
        console.error(err);
      }
    }

    async function fetchRates() {
      const base = fromSelect.value;
      const res = await fetch(`https://api.exchangerate.host/latest?base=${base}`);
      const data = await res.json();
      allRates = data.rates;
      updateRatesTable();
      convertAmount();
      updatedTime.innerText = `آخر تحديث: ${new Date().toLocaleString('ar-EG')}`;
    }

    function updateRatesTable() {
      ratesBody.innerHTML = '';
      for (let currency in allRates) {
        const row = document.createElement('tr');
        const td1 = document.createElement('td');
        td1.innerText = currency;
        const td2 = document.createElement('td');
        td2.innerText = allRates[currency].toFixed(3);
        row.appendChild(td1);
        row.appendChild(td2);
        ratesBody.appendChild(row);
      }
    }

    function convertAmount() {
      const amount = parseFloat(document.getElementById('amount').value);
      const from = fromSelect.value;
      const to = toSelect.value;

      if (!allRates[to]) {
        resultDiv.innerText = 'جاري الحساب...';
        return;
      }

      const result = amount * allRates[to];
      resultDiv.innerText = `${amount} ${from} = ${result.toFixed(2)} ${to}`;
    }

    fromSelect.addEventListener('change', fetchRates);
    toSelect.addEventListener('change', convertAmount);

    loadSymbols();
    setInterval(fetchRates, 3600000); // كل ساعة
  </script>

</body>
</html>